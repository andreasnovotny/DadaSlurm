#!/bin/Rscript -l

##########################################################################################################
############### DADA2 PIPELINE 8 : Ad Phylogeny to Phyloseq ##############################################
##########################################################################################################
####                                                                                                  ####
#### Andreas Novotny, 2018-02                                                                         ####
#### https://github.com/andreasnovotny/DadaSlurm                                                      ####
####                                                                                                  ####
##########################################################################################################
##########################################################################################################
##########################################################################################################

library(phyloseq)

print('R will now ad the tree to the phyloseq object... ...')

args <- commandArgs(TRUE)
CURRENT_DIR <- args[1]

phylogeny <- readRDS(file.path(CURRENT_DIR,'phangorn_tree.rds'))
ps <- readRDS(file.path(CURRENT_DIR,'phyloseq.rds'))

ps@phy_tree <- phylogeny$tree

saveRDS(ps, paste(CURRENT_DIR,'/phyloseq.rds', sep=""))

##########################################################################################################
##########################################################################################################
